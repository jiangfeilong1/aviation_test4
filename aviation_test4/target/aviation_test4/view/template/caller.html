<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>搜索</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="../../layuiadmin/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="../../layuiadmin/style/admin.css" media="all">
  <link rel="stylesheet" href="../../layuiadmin/style/template.css" media="all">
</head>
<body>
<div class="layui-fluid">
  <div class="layui-row layui-col-space15">
    <div class="layui-col-md12">
      <div class="layui-card">
        <div class="layui-card-header">个人信息修改</div>
        <div class="layui-card-body">
            <div class="layui-col-md10">
              <form class="layui-form layui-from-pane" style="margin-top:20px" name="form1" lay-filter="formTest">
                <div class="layui-form-item">
                  <label class="layui-form-label">用户名</label>
                  <div class="layui-input-block">
                    <input type="text" name="username" id="username1"   class="layui-input" disabled>
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">密码</label>
                  <div class="layui-input-block">
                    <input type="password" name="password" id="password1"  class="layui-input" disabled >
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">真实姓名</label>
                  <div class="layui-input-block">
                    <input type="text" name="realname" id="realname1"  class="layui-input" required >
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">邮箱</label>
                  <div class="layui-input-block">
                    <input type="text" name="email" id="email1"   class="layui-input" required lay-verify="email">
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">用户描述</label>
                  <div class="layui-input-block">
                    <input type="text" name="description" id="description1"  class="layui-input" >
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">用户电话</label>
                  <div class="layui-input-block">
                    <input type="text" name="phone" id="phone1"  class="layui-input" required lay-verify="phone">
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">用户地址</label>
                  <div class="layui-input-block">
                    <input type="text" name="address" id="address1"   class="layui-input">
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">提问问题</label>
                  <div class="layui-input-block">
                    <input type="text" name="question" id="question1"  class="layui-input" >
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">提问答案</label>
                  <div class="layui-input-block">
                    <input type="text" name="answer" id="answer1"  class="layui-input" >
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">所在省份</label>
                  <div class="layui-input-block">
                    <select name="province" lay-verify="required" id="province1" onchange='addOption()'>
                      <option value="">请选择</option>
                      <option value="1">北京市</option>
                      <option value="2">天津市</option>
                      <option value="3">河北省</option>
                      <option value="4">山西省</option>
                      <option value="5">内蒙古自治区</option>
                      <option value="6">辽宁省</option>
                      <option value="7">吉林省</option>
                      <option value="8">黑龙江省</option>
                      <option value="9">上海市</option>
                      <option value="10">江苏省</option>
                      <option value="11">浙江省</option>
                      <option value="12">安徽省</option>
                      <option value="13">福建省</option>
                      <option value="14">江西省</option>
                      <option value="15">山东省</option>
                      <option value="16">河南省</option>
                      <option value="17">湖北省</option>
                      <option value="18">湖南省</option>
                      <option value="19">广东省</option>
                      <option value="20">广西壮族自治区</option>
                      <option value="21">海南省</option>
                      <option value="22">重庆市</option>
                      <option value="23">四川省</option>
                      <option value="24">贵州省</option>
                      <option value="25">云南省</option>
                      <option value="26">西藏自治区</option>
                      <option value="27">陕西省</option>
                      <option value="28">甘肃省</option>
                      <option value="29">青海省</option>
                      <option value="30">宁夏回族自治区</option>
                      <option value="31">新疆维吾尔自治区</option>
                    </select>
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">所在城市</label>
                  <div class="layui-input-block">
                    <input type="text" name="city" lay-verify="required" id="city1"  class="layui-input" >
                  </div>
                </div>
                <div class="layui-form-item">
                  <label class="layui-form-label">注册日期</label>
                  <div class="layui-input-block">
                    <input type="date" name="regdate" id="regdate1"  class="layui-input" disabled>
                  </div>
                </div>
                <div class="layui-form-item" style="margin-top:40px">
                  <div class="layui-input-block">
                    <button class="layui-btn  layui-btn-submit " lay-submit="" lay-filter="formDemo" >确认修改</button>
                  </div>
                </div>
              </form>
            </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="../../layuiadmin/layui/layui.js"></script>
<script>
  //Demo
  layui.config({
    base: '../../layuiadmin/' //静态资源所在路径
  }).extend({
    index: 'lib/index' //主入口模块
  }).use(['form','layer'], function(){
    const $ = layui.$
            , form = layui.form
            , layer = layui.layer;

//创建二维数组存储市级数据
    const city = new Object();
    city[1]=new Array('北京市');
    city[2]=new Array('天津市');
    city[3]=new Array('石家庄','张家口','承德','秦皇岛','唐山','廊坊','保定','沧州','衡水','邢台','邯郸');
    city[4]=new Array('太原','大同','朔州','阳泉','长治','晋城','忻州地区','吕梁地区','晋中','临汾地区','运城地区');
    city[5]=new Array('呼和浩特','包头','乌海','赤市峰','通辽','鄂尔多斯','呼伦贝尔','巴彦淖尔','乌兰察布','兴安',"锡林郭勒","阿拉善");
    city[6]=new Array('沈阳','大连','鞍山','抚顺','本溪','丹东','锦州','营口','阜新','辽阳','盘锦','铁岭','朝阳','葫芦岛');
    city[7]=new Array('长春','吉林','四平','辽源','通化','白山','松原','白城','延边');
    city[8]=new Array('哈尔滨','齐齐哈尔','鸡西','鹤岗','双鸭山','大庆','伊春','佳木斯','七台河','牡丹江','黑河','绥化','大兴安岭');
    city[9]=new Array('上海');
    city[10]=new Array('南京','无锡','徐州','常州','苏州','南通','连云港','淮安','盐城','扬州',' 镇江','泰州','宿迁');
    city[11]=new Array('杭州','宁波','温州','嘉兴','湖州','绍兴','金华','衢州','舟山','台州','丽水');
    city[12]=new Array('合肥','芜湖','蚌埠','淮南','马鞍山','淮北','铜陵','安庆','黄山','滁州','阜阳','宿州','巢湖','六安','亳州','池州','宣城');
    city[13]=new Array('福州','厦门','莆田','三明','泉州','漳州','南平','龙岩','宁德');
    city[14]=new Array('南昌','景德镇','萍乡','九江','新余','鹰潭','赣州','吉安','宜春','抚州','上饶');
    city[15]=new Array('济南','青岛','淄博','枣庄','东营','烟台','潍坊','威海','济宁','泰安','日照','莱芜','临沂','德州','聊城' ,'滨州', '菏泽');
    city[16]=new Array('郑州','开封','洛阳','平顶山','焦作','鹤壁','新乡','安阳','濮阳','许昌','漯河','三门峡','南阳','商丘','信阳','周口','驻马店');
    city[17]=new Array( '武汉','黄石','襄樊','十堰','荆州','宜昌','荆门','鄂州','孝感','黄冈','咸宁','随州','恩施');
    city[18]=new Array('长沙','株洲','湘潭','衡阳','邵阳','岳阳','常德','张家界','益阳','郴州','永州','怀化','娄底','湘西');
    city[19]=new Array('广州','深圳','珠海','汕头','韶关','佛山','江门','湛江','茂名','肇庆','惠州','梅州','汕尾','河源','阳江','清远','东莞','中山','潮州','揭阳','云浮');
    city[20]=new Array('南宁','柳州','桂林','梧州','北海','防城港','钦州','贵港','玉林','百色','贺州','河池','来宾','崇左');
    city[21]=new Array('海口','三亚');
    city[22]=new Array('重庆市');
    city[23]=new Array('成都','自贡','攀枝花','泸州','德阳','绵阳','广元','遂宁','内江','乐山','南充','宜宾','广安','达州','眉山','雅安','巴中','资阳','阿坝','凉山');
    city[24]=new Array( '贵阳','六盘水','遵义','安顺','铜仁','毕节','黔西南','黔东南','黔南');
    city[25]=new Array('昆明','曲靖','玉溪','保山','昭通','丽江','普洱','临沧','文山','红河','西双版纳','楚雄','大理','德宏','怒江','迪庆');
    city[26]=new Array('拉萨','昌都','山南','那曲','阿里','林芝');
    city[27]=new Array('西安','铜川','宝鸡','咸阳','渭南','延安','汉中','榆林','安康','商洛');
    city[28]=new Array('兰州','嘉峪关','金昌','白银','天水','武威','张掖','平凉','酒泉','庆阳','定西','陇南','临夏','甘南');
    city[29]=new Array('西宁','海东','海北','黄南','海南','果洛','玉树','海西');
    city[30]=new Array('银川','石嘴山','吴忠','固原','中卫');
    city[31]=new Array('乌鲁木齐','克拉玛依','吐鲁番' ,'哈密','和田','阿克苏','喀什','克孜勒苏柯尔克孜','巴音郭楞蒙古','昌吉','博尔塔拉蒙古','伊犁哈萨克','塔城','阿勒泰');


    function addOption() {
      const select2 = document.getElementById("city1");
      const select1 = document.getElementById("province1").value;
      select2.length = 0; //每次都先清空一下市级菜单
      if(select1 != '请选择省份') {
        for(const i in city[select1 ]) {
          select2.add(new Option(city[select1][i], city[select1][i]), null);
        }
      }else if (sheng == '请选择省份'){
        select2.length = 0;
        select2.add(new Option("请选择城市", "请选择城市"), null);
      }
    }
    function x() {
      $.ajax({
        url: '../../test/sessionTicketUser'
        ,success:function (res) {
          if (res.code === 0){
            const regdate = new  Date(res.data.regdate).Format("yyyy-MM-dd");
            form.val("formTest",{
              "username": res.data.username
              ,"password": res.data.password
              ,"realname": res.data.realname
              ,"email": res.data.email
              ,"description": res.data.description
              ,"phone": res.data.phone
              ,"address": res.data.address
              ,"question": res.data.question
              ,"answer": res.data.answer
              ,"province": res.data.province
              ,"city": res.data.city
              ,"regdate": regdate
            });
          }
        }
      })
    }
    window.onload = x();
    //监听提交
    form.on('submit(formDemo)', function(data) {
      $.ajax({
        url:'../../test/edit5',
        type:'post',
        contentType:'application/json',
        data:JSON.stringify(data.field),
        success:function (res) {
          if(res != null){
            layer.closeAll('loading');
            layer.load(2);
            layer.msg("修改成功");
            setTimeout(function(){
              layer.closeAll();//关闭所有的弹出层
              table.reload("demo");
            }, 1000);
          }else{
            layer.msg("修改失败");
          }
        }
      })
      return false;
    })
    Date.prototype.Format = function (fmt){
      const o = {
        "M+": this.getMonth() + 1,                 //月份
        "d+": this.getDate(),                    //日
        "h+": this.getHours(),                   //小时
        "m+": this.getMinutes(),                 //分
        "s+": this.getSeconds(),                 //秒
        "q+": Math.floor((this.getMonth() + 3) / 3), //季度
        "S": this.getMilliseconds()             //毫秒
      };
      if(/(y+)/.test(fmt))
        fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));
      for(var k in o)
        if(new RegExp("("+ k +")").test(fmt))
          fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
      return fmt;
    }
  });

</script>
</body>
</html>
